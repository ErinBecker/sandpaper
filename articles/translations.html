<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sandpaper">
<title>Translating The Workbench • sandpaper</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Translating The Workbench">
<meta property="og:description" content="sandpaper">
<meta property="og:image" content="https://carpentries.github.io/sandpaper/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@zkamvar">
<meta name="twitter:site" content="@thecarpentries">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sandpaper</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.16.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/building-with-renv.html">Building Lessons With A Package Cache</a>
    <a class="dropdown-item" href="../articles/automated-pull-requests.html">Working with Automated Pull Requests</a>
    <a class="dropdown-item" href="../articles/include-child-documents.html">Including Child Documents</a>
    <a class="dropdown-item" href="../articles/translations.html">Translating The Workbench</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/carpentries/sandpaper/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Translating The Workbench</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/carpentries/sandpaper/blob/HEAD/vignettes/translations.Rmd" class="external-link"><code>vignettes/translations.Rmd</code></a></small>
      <div class="d-none name"><code>translations.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The philosophy of The Carpentries Workbench is one of separation
between lesson content and the tooling needed to transform that content
into a website. It is possible to write a lesson in any human language
that has a syllabary which can be represented on a computer. The only
catch is: by default the language of the <em>website template</em>—all
the navigational elements of the website—is English, so authors need to
tell The Workbench what language the website template should use.</p>
<p>To write a lesson in a specific language, the lesson author should
add <code>lang: 'xx'</code> to the <code>config.yaml</code> file where
<code>xx</code> represents the <a href="https://www.gnu.org/software/gettext/manual/html_node/Usual-Language-Codes.html" class="external-link">language
code</a> that matches the language of the lesson content. This defaults
to <code>"en"</code>, but can be any language code (e.g. “ja” specifying
Japanese) or combination language code and <a href="https://www.gnu.org/software/gettext/manual/html_node/Country-Codes.html" class="external-link">country
code</a> (e.g. “pt_BR” specifies Pourtugese used in Brazil). For more
information on how this is used, see <a href="https://www.gnu.org/software/gettext/manual/html_node/Locale-Names.html" class="external-link">the
Locale Names section of the gettext manual</a>. If there is
country-specific variation for a language that needs to be added, it is
not necessary to re-translate everything that is identical in the
original language file—you only need to translate what is different.</p>
<p>Setting the <code>lang:</code> keyword will allow the lesson
navigational elements of the website template to be presented in the
same language as the lesson content <em>if the language has been added
to {sandpaper}</em>. If not, the menu items will appear in English.</p>
<p>This vignette is of interest to those who wish to update translations
or add new translations. In this vignette I will provide resources for
updating and adding new languages, the process by which translation
happens, and I will outline special syntax used in {sandpaper}.</p>
</div>
<div class="section level2">
<h2 id="resources">Resources<a class="anchor" aria-label="anchor" href="#resources"></a>
</h2>
<div class="section level3">
<h3 id="recommended-tools">Recommended Tools<a class="anchor" aria-label="anchor" href="#recommended-tools"></a>
</h3>
<p>To provide translations as a non-maintainer, you need only a text
editor to add translations to the strings present in the
<code>.po</code> translation files (see more about these files in the <a href="#translating-in-sandpaper">Translating in {sandpaper}
section</a>.</p>
<p>If you would like to compile and test these translations locally, you
will need the <a href="https://michaelchirico.github.io/potools/" class="external-link">{potools} package</a>,
which requires the <a href="https://www.gnu.org/software/gettext/" class="external-link">GNU
gettext system</a>. As mentioned in the <a href="https://michaelchirico.github.io/potools/#installation" class="external-link">{potools}
installation documentation</a>, if you are on macOS, you will likely
need to use <code>brew</code> to install <code>gettext</code> with
<code>brew install gettext</code>, otherwise, it is bundled with RTools
(needed for package development on Windows) and it is present on most
Linux distributions.</p>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>The documentation for the {potools} package is a wonderful resource.
Use <code><a href="https://michaelchirico.github.io/potools/articles/translators.html" class="external-link">vignette("translators", package = "potools")</a></code> to read
details about what to consider when translating text in a package.
Another really good resource is <a href="https://masalmon.eu/2023/10/06/potools-mwe/" class="external-link">a blog post by Maëlle
Salmon</a> which gives a minimum working example of translating package
messages using {potools}.</p>
<p>If you are interested in translating <em>lesson content</em>, please
consult Joel Nitta’s <a href="https://hackmd.io/@joelnitta/SkCSC6ZNT#Guide-for-translators-l10n" class="external-link">Carpentries
translation guide</a>.</p>
<p>You can use tools such as Joel Nitta’s <a href="https://github.com/joelnitta/dovetail#readme" class="external-link">{dovetail}</a> for
providing a method for translators to track and deploy translations of
Carpentries lessons. You can also use rOpenSci’s <a href="https://docs.ropensci.org/babeldown/" class="external-link">{babeldown}</a>, which uses
the DeepL API for automated translation that translators can edit
afterwards.</p>
</div>
</div>
<div class="section level2">
<h2 id="translating-in-sandpaper">Translating in {sandpaper}<a class="anchor" aria-label="anchor" href="#translating-in-sandpaper"></a>
</h2>
<p>The translations from {sandpaper} are mostly shuffled off to
{varnish}, where it has template variables written in mustache
templating. These variables define visible menu text such as “Key
Points” and screen-reader accessible text for buttons such as “close
menu”.</p>
<p>There are 3 languages that are known to {sandpaper}:</p>
<ul>
<li>en</li>
<li>es</li>
<li>ja</li>
</ul>
<p>If a language is not known to {sandpaper} and a lesson attempts to
use that language, it will default back to English (the source
language).</p>
<div class="section level3">
<h3 id="the-source-files-of-translations">The source files of translations<a class="anchor" aria-label="anchor" href="#the-source-files-of-translations"></a>
</h3>
<p>When you translate in {sandpaper}, you will be working with
<code>.po</code> files, which are text files that live in <a href="https://github.com/carpentries/sandpaper/tree/HEAD/po" class="external-link">the po/
folder</a> in the source of this package. There is one <code>.po</code>
file per language translated. The syntax looks like this, where the
first line shows the file where the translation exists, the second line
gives the message in English, and the third line gives the
translation:</p>
<pre class="po"><code>#: build_404.R:57
msgid "Page not found"
msgstr "ページが見つかりません"</code></pre>
<p>These files are recognised by <a href="https://michaelchirico.github.io/potools/#alternative-software" class="external-link">several
well-established graphical user interfaces</a>, but since they are text
files, you can edit them in any text editor or on GitHub directly.</p>
</div>
<div class="section level3">
<h3 id="how-translations-are-processed-in-r">How translations are processed in R<a class="anchor" aria-label="anchor" href="#how-translations-are-processed-in-r"></a>
</h3>
<p>These po files are compiled into binary <code>.mo</code> files that
are carried with the built package on to the user’s computer. These
files are used by the R function <code><a href="https://rdrr.io/r/base/gettext.html" class="external-link">base::gettext()</a></code> to
translate messages in a specific context. The context for {sandpaper} is
known as <code>R-sandpaper</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://withr.r-lib.org" class="external-link">"withr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://carpentries.github.io/sandpaper/">"sandpaper"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/known_languages.html">known_languages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "en" "es" "ja"</span></span>
<span><span class="fu"><a href="https://withr.r-lib.org/reference/with_language.html" class="external-link">with_language</a></span><span class="op">(</span><span class="st">"ja"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Encoding.html" class="external-link">enc2utf8</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gettext.html" class="external-link">gettext</a></span><span class="op">(</span><span class="st">"Page not found"</span>, domain <span class="op">=</span> <span class="st">"R-sandpaper"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ページが見つかりません"</span></span>
<span><span class="fu"><a href="https://withr.r-lib.org/reference/with_language.html" class="external-link">with_language</a></span><span class="op">(</span><span class="st">"en"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Encoding.html" class="external-link">enc2utf8</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gettext.html" class="external-link">gettext</a></span><span class="op">(</span><span class="st">"Page not found"</span>, domain <span class="op">=</span> <span class="st">"R-sandpaper"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Page not found"</span></span></code></pre></div>
<p>If a language does not exist, it will revert to English:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://withr.r-lib.org/reference/with_language.html" class="external-link">with_language</a></span><span class="op">(</span><span class="st">"xx"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Encoding.html" class="external-link">enc2utf8</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gettext.html" class="external-link">gettext</a></span><span class="op">(</span><span class="st">"Page not found"</span>, domain <span class="op">=</span> <span class="st">"R-sandpaper"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Page not found"</span></span></code></pre></div>
<p>To make translation keys easier to detect, a convenience function,
<code>tr_()</code> has been defined, so if you want to find the context
for a given translation key, you can find it by searching the source
code for <code>tr_</code>.</p>
</div>
<div class="section level3">
<h3 id="special-syntax-for-translators">Special syntax for translators<a class="anchor" aria-label="anchor" href="#special-syntax-for-translators"></a>
</h3>
<p>Some content for translation requires variables or markup to be added
after translation.</p>
<p>Items in <code>{curly_braces}</code> are variables and should remain
in English:</p>
<pre class="po"><code>#: utils-translate.R:52
msgid "Estimated time: {icons$clock} {minutes} minutes"
msgstr "所要時間：{icons$clock} {minutes}分"</code></pre>
<p>Words in <code>&lt;(kirby quotes)&gt;</code> will have HTML markup
surrounding them and should be translated:</p>
<pre><code>#: utils-translate.R:62
msgid "This lesson is subject to the &lt;(Code of Conduct)&gt;"
msgstr "このレッスンは&lt;(行動規範)&gt;の対象となります"</code></pre>
</div>
<div class="section level3">
<h3 id="updates-to-translations">Updates to translations<a class="anchor" aria-label="anchor" href="#updates-to-translations"></a>
</h3>
<p>There may be times in the future where translations will need to be
updated because text changes or is added. When this happens, the
maintainer of {sandpaper} will run the following commands to extract the
new translation strings, update all languages, and recompile the
<code>.mo</code> files for the built package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">potools</span><span class="fu">::</span><span class="fu">po_extract</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">potools</span><span class="fu">::</span><span class="fu">po_update</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">potools</span><span class="fu">::</span><span class="fu">po_compile</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>When the languages are updated, the translation utility will attempt
to make fuzzy matches or create new strings. For example, if we update
the “Page not found” translation to be title case, add punctuation and a
little whimsy to be <code>"Page? Not Found! -_-;"</code>, when you go to
edit your translation, you might see something like this:</p>
<pre class="po"><code>#: build_404.R:57
#, fuzzy
#| msgid "Page not found"
msgid "Page? Not Found! -_-;"
msgstr "ページが見つかりません"</code></pre>
<p>The old translation will be used until a translator updates it and
runs <code>potools::po_compile()</code> to update the <code>.mo</code>
files.</p>
<p>When new strings for translations are added, the translation utility
does not assume to know anything about translation and the will appear
like so:</p>
<pre class="po"><code>#: build_404.R:57
msgid "A new translation approaches!"
msgstr ""</code></pre>
<p>If no translation is available for a given string, it will default to
the string itself:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://withr.r-lib.org/reference/with_language.html" class="external-link">with_language</a></span><span class="op">(</span><span class="st">"ja"</span>, <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Encoding.html" class="external-link">enc2utf8</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gettext.html" class="external-link">gettext</a></span><span class="op">(</span><span class="st">"A new translation approaches!"</span>, domain <span class="op">=</span> <span class="st">"R-sandpaper"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A new translation approaches!"</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhian N. Kamvar, Joel H. Nitta.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
